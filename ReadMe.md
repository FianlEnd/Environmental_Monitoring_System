# ***接口说明***
(除了登录和注册接口，其他接口都需要在header里添加token,token有效时间12h，密码用户名合法检测已经注释便于调试，验证码有效时间40min)
***
前端发送信息到mqtt服务端（测试）
```
http://localhost:8080/mqtt/send?topic=7data&msg=31;12;31
```
***
自动报警功能：当最新的可燃气体数据超过150时，向所有CITY_MANAGER用户发送警报邮件
***
## 1. 注册账号
**接口地址**: `/register`
**请求方式**: `POST`
**请求参数**:
    body:
        ```
        {
            "username": "string",
            "email": "string",
            "password": "string"
            "role": "string",
            "code": "string"        
        }```
**返回参数**:

        {
          "code" : number,
          "msg" : "string",
          "data" : {
            "userId" : number,
            "email" : "string",
            "role" : "string",
            "token" : "string"
          }
        }
        
## 2. 登录
**接口地址**: `/login`
**请求方式**: `POST`
**请求参数**:
    body:
        ```
        {
            "email": "string",
            "password": "string"
        }```
**返回参数**:

        {
          "code" : number,
          "msg" : "string",
          "data" : {
            "userId" : number,
            "email" : "string",
            "role" : "string",
            "token" : "string"
          }
        }
        
## 3. 修改密码
**接口地址**: `/user/updatePassword`
**请求方式**: `POST`
**请求参数**:
    body:
        ```
        {
            "oldPassword": "string",
            "newPassword": "string"
        }```
**返回参数**:
        
        {
            "code" : number,
            "msg" : "string",
            "data" : "string"
        }

## 4. 发送验证码
**接口地址**: `/register/sendEmail`
**请求方式**: `GET`
**请求参数**: ?email=your_email@example.com
**返回参数**: 

        {
            "code" : number,
            "msg" : "string",
            "data" : null
        }

## 5. 前端获取开发板记录数据
**接口地址**: `/board/getData`
**请求方式**: `GET`
**请求参数**: 无
**返回参数**:

    {
        "code" : 1,
        "msg" : "success",
        "data" : [ {
        "temperature" : 31.0,
        "humidity" : 12.0,
        "combustibleGas" : 31.0,
        "recordTime" : "2025-06-28T12:42:01"
        }, {
        "temperature" : 71.0,
        "humidity" : 99.0,
        "combustibleGas" : 12.0,
        "recordTime" : "2025-06-28T14:13:56"
        } ]
    }
## 6. 获取最新数据
**接口地址**: `/getLatestData`
**请求方式**: `GET`
**请求参数**: 无
**返回参数**:

    {
        "code" : 1,
        "msg" : "success",
        "data" : {
        "temperature" : 31.0,
        "humidity" : 12.0,
        "combustibleGas" : 90.0,
        "recordTime" : "2025-06-28T15:17:33"
        }
    }
## 7.ai问答
**接口地址**: `/chat`
**请求方式**: `GET`
**请求参数**: /chat?prompt=告诉我你获取的信息
**返回参数**:

    {
    "code": 1,
    "msg": "success",
    "data": "从您提供的近期40条环境数据中，我可以看到部分数据记录包含了温度（temperature）、湿度（humidity）、可燃气体浓度（combustibleGas）以及记录时间（recordTime）这几个关键信息。这些数据反映了在不同时间点的环境状态。\n\n### 从您提供的一小部分数据中，可以总结出以下几点：\n1. **时间范围**：  \n   - 数据的时间跨度为2025年6月28日到2025年6月29日。\n   - 具体记录时间包括中午和下午时段（例如12:42、14:13、15:17等）。\n\n2. **温度（temperature）**：\n   - 温度范围：31.0°C 至 71.0°C。\n   - 最高温度出现在2025-06-28T14:13:56，为71.0°C。\n   - 多次记录显示温度为31.0°C，这可能是基准值或常见状态。\n\n3. **湿度（humidity）**：\n   - 湿度范围：12.0% 至 99.0%。\n   - 最高湿度出现在2025-06-28T14:13:56，为99.0%。\n   - 部分时间段湿度较低，如多次记录显示湿度为30.0%。\n\n4. **可燃气体浓度（combustibleGas）**：\n   - 可燃气体浓度范围：12.0 至 90.0。\n   - 最高值出现在2025-06-28T15:17:33，为90.0。\n   - 在某些时间段，该数值保持稳定（如多次记录为34.0）。\n\n5. **数据规律性**：\n   - 有些记录的时间间隔较短，比如2025-06-29T16:35:52、2025-06-29T16:37:21、2025-06-29T16:41:01和2025-06-29T16:43:58，可能表示系统在这段时间内进行了密集监测。\n\n### 总结：\n从这些数据中可以看出，环境条件在短时间内可能会发生显著变化（例如温度、湿度和可燃气体浓度）。如果这是用于监测某种特殊环境（如工业设备、实验室或危险区域），那么需要特别注意极端值，尤其是高温、高湿度或高可燃气体浓度的情况，以确保安全。\n\n如果您有更具体的问题（例如分析趋势、异常值或建议措施），请告诉我！"
    }

## 8. 获取可燃气体警告阈值
**接口地址**: `/getThreshold`
**请求方式**: `GET`
**请求参数**: 无
**返回参数**:

    {
    "code" : 1,
    "msg" : "success",
    "data" : 160.0
    }

## 9. 修改可燃气体警告阈值
**接口地址**: `/setThreshold`
**请求方式**: `Get`
**请求参数**:?threshold=your_threshold
**返回参数**:

    {
    "code" : 1,
    "msg" : "success",
    "data" : "阈值设置成功"
    }

## 10. ai分析数据
（ message: 这是近期50条的环境数据：....... 请分析这些数据,最后不要加类似有什么再问我这种意思的话 ）
（ 在AiController中修改message）
**接口地址**: `/analysisChat`
**请求方式**: `GET`
**请求参数**: 无
**返回参数**:

    {
    "code": 1,
    "msg": "success",
    "data": "从你提供的7条环境数据来看，这些数据包含了温度（temperature）、湿度（humidity）和可燃气体浓度（combustibleGas）三个维度的记录，时间范围覆盖了2025年6月28日至29日。以下是对这些数据的分析：\n\n---\n\n### 一、温度分析\n\n- **整体范围**：温度值分布在 **31.0°C 至 71.0°C** 之间。\n- **最大值出现在**：2025-06-28T14:13:56，为 **71.0°C**，显著高于其他记录。\n- **其余记录温度均为31.0°C**，说明在大多数时间段内温度较为稳定。\n\n> **结论**：存在一个明显的高温异常点（71°C），其余时间温度保持在31°C左右，可能表示设备或传感器出现短暂异常，或者该时间段确实发生了环境升温事件。\n\n---\n\n### 二、湿度分析\n\n- **整体范围**：湿度值分布在 **12.0% 至 99.0%** 之间。\n- **高湿情况**：与最高温度记录同时发生的是 **99.0% 湿度**，这可能是记录错误，也可能是特殊环境下的真实数据。\n- **多数情况下湿度在12.0%~30.0%之间**，属于较干燥的环境。\n\n> **结论**：湿度波动较大，尤其在2025-06-28T14:13:56出现极端高湿值，需结合实际情况判断是否为传感器误差或真实环境变化。\n\n---\n\n### 三、可燃气体浓度分析\n\n- **整体范围**：可燃气体浓度分布在 **12.0 至 90.0** 单位之间。\n- **正常水平**：大部分记录集中在 **31.0~34.0** 范围内。\n- **最高值出现在**：2025-06-28T15:17:33，达到 **90.0**，为潜在安全隐患。\n- **最低值出现在**：2025-06-28T14:13:56，为 **12.0**，与高温高湿记录同时发生。\n\n> **结论**：可燃气体浓度总体处于中低水平，但存在一次较高浓度（90.0）记录，应引起注意，排查是否存在泄漏或其他风险因素。\n\n---\n\n### 四、时间序列观察\n\n- **连续记录密集时间段**：\n  - 2025-06-29T16:35:52 ~ 2025-06-29T16:43:58，共4条记录，间隔短且各项参数基本一致，表明环境趋于稳定。\n- **异常组合记录**：\n  - 2025-06-28T14:13:56：高温（71°C）+ 高湿（99%）+ 低可燃气体（12）\n  - 2025-06-28T15:17:33：正常温湿度 + 高可燃气体（90）\n\n> **结论**：建议重点核查这两个时间节点的数据真实性及对应时间段的现场状况，尤其是高可燃气体浓度的情况。\n\n---\n\n### 五、综合判断与建议\n\n| 维度 | 最大值 | 最小值 | 平均值估算 | 异常点 |\n|------|--------|--------|-------------|---------|\n| 温度 | 71.0°C | 31.0°C | ~38.0°C     | 71°C 需核实 |\n| 湿度 | 99.0%  | 12.0%  | ~30.0%      | 99% 高湿需核实 |\n| 可燃气体 | 90.0 | 12.0   | ~36.0       | 90.0 存在安全风险 |\n\n- **建议操作**：\n  1. 对 **2025-06-28T14:13:56** 的高温高湿低可燃气体组合进行核查，是否存在传感器故障。\n  2. 对 **2025-06-28T15:17:33** 的高可燃气体浓度进行安全评估，确认是否采取了相应措施。\n  3. 在后续数据采集过程中增加异常值过滤机制，提高数据可靠性。\n\n--- \n\n如需进一步趋势图、分布统计或报警规则设定，可提供更多信息继续分析。"
    }


    